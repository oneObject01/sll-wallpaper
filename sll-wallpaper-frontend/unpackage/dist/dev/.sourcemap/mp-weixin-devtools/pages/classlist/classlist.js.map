{"version":3,"names":["contentText","contentdown","contentrefresh","contentnomore","wallListPic","common_vendor","ref","storageKey","classId","noMore","status","onLoad","e","id","value","classid","pageSize","pageNum","getWallListPic","onunload","index","removeStorageSync","__f__","goBack","navigateBack","onReachBottom","_asyncToGenerator2","_regeneratorRuntime2","mark","_callee","wrap","_callee$","_context","prev","next","abrupt","stop","_ref2","_callee2","res","_callee2$","_context2","api_apis","apiGetWallListPic","sent","concat","_toConsumableArray2","data","length","setStorageSync","err","apply","arguments","wx","createPage","MiniProgramPage"],"sources":["classlist.vue","cGFnZXMvY2xhc3NsaXN0L2NsYXNzbGlzdC52dWU"],"sourcesContent":["<template>\n\t<view class=\"classlist\">\r\n\t\t<view class=\"mask\">\r\n\t\t\t<view class=\"goBack\" @click=\"goBack\" :style=\"{top:getStatusBarHeight()+'px'}\">\r\n\t\t\t\t<uni-icons type=\"back\" color=\"#fff\" size=\"20\"></uni-icons>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\t\t<view class=\"boxs\">\r\n\t\t\t<navigator :url=\"'/pages/preview/preview?id='+item._id+'&key='+storageKey\" class=\"box\" v-for=\"item in wallListPic\" :key=\"item._id\">\r\n\t\t\t\t\t<image :src=\"item.smallPicurl\" mode=\"aspectFill\" :ket=\"item._id\"></image>\r\n\t\t\t</navigator>\r\n\t\t</view>\r\n\t\t<view class=\"load\">\r\n\t\t\t<uni-load-more :status=\"status\" :contentText=\"contentText\"/>\r\n\t\t</view>\n\t</view>\n</template>\n\n<script setup>\r\nimport { ref } from 'vue';\r\nimport {onLoad,onReachBottom} from \"@dcloudio/uni-app\"\nimport { apiGetWallListPic } from '../../api/apis';\r\nimport {getStatusBarHeight} from \"@/utils/system.js\"\r\nconst contentText = {contentdown: \"上拉显示更多\",contentrefresh: \"正在加载...\",contentnomore: \"没有更多图片了\"}\r\nconst wallListPic = ref([])\r\nlet storageKey = null\r\nlet classId = ref({})\r\nlet noMore = false\r\nlet status = ref('loading')\r\n\r\nonLoad(e=>{\r\n\t//获取url参数id的值\r\n\tlet {id} = e\r\n\tstorageKey = id\r\n\t//给请求data参数赋值\r\n\tclassId.value.classid = id\r\n\tclassId.value.pageSize = 12\r\n\tclassId.value.pageNum = 1\r\n\tgetWallListPic()\r\n})\r\n\r\nonunload(()=>{\r\n\ttry {\r\n\t\tuni.removeStorageSync(storageKey);\r\n\t} catch (e) {\r\n\t\tconsole.log(e)\r\n\t}\r\n})\r\n\r\nconst goBack = () => {\r\n\tuni.navigateBack()\r\n}\r\n\r\nonReachBottom( async ()=>{\r\n\t//触底有其他图片则进行网络请求，没有则不执行\r\n\tif(noMore)return\r\n\tclassId.value.pageNum++\r\n\tgetWallListPic()\r\n})\r\n\r\nconst getWallListPic = async ()=>{\r\n\t//获取响应数据\r\n\tconst res = await apiGetWallListPic(classId.value)\r\n\twallListPic.value = [...wallListPic.value,...res.data]\r\n\t//判断服务器是否还有更多图片\r\n\tif(res.data.length<12){\r\n\t\tnoMore = true\r\n\t\tstatus.value = 'noMore'\r\n\t}\r\n\t//将数据本地缓存\r\n\ttry {\r\n\t  uni.setStorageSync(storageKey, wallListPic.value);\r\n\t} catch (err) {\r\n\t  console.error('存储失败', err);\r\n\t}\r\n}\r\n\r\n\n</script>\n\n<style lang=\"scss\" scoped>\n.classlist{\r\n\tposition: relative;\r\n\twidth: 100vw;\r\n\theight: 100vh;\r\n\t.mask{\r\n\t\t.goBack {\r\n\t\t    width: 76rpx;\r\n\t\t    height: 76rpx;\r\n\t\t\tpadding: 20rpx;\r\n\t\t    background: rgba(0, 0, 0, 0.5);\r\n\t\t    left: 30rpx;\r\n\t\t    top: 30rpx; /* 增加顶部间距 */\r\n\t\t    margin-left: 0;\r\n\t\t    border-radius: 50%;\r\n\t\t    backdrop-filter: blur(10rpx);\r\n\t\t    border: 1rpx solid rgba(255, 255, 255, 0.3);\r\n\t\t    display: flex;\r\n\t\t    align-items: center;\r\n\t\t    justify-content: center;\r\n\t\t    position: fixed; /* 使用 fixed 定位确保相对于屏幕 */\r\n\t\t}\n\t}\r\n\t.boxs{\r\n\t\twidth: 100%;\r\n\t\tpadding: 5rpx;\r\n\t\tdisplay: grid;\r\n\t\tgrid-template-columns: repeat(3,1fr);\r\n\t\tgap: 5rpx;\r\n\t\t.box{\r\n\t\t\twidth: 100%;\r\n\t\t\theight: 545rpx;\r\n\t\t\timage{\r\n\t\t\t\twidth: 100%;\r\n\t\t\t\theight: 100%;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t.load{\r\n\t\tpadding: 30rpx 0;\r\n\t}\r\n}\n</style>\n","import MiniProgramPage from 'C:/Users/yuweikai/Documents/HBuilderProjects/sll-wallpaper/sll-wallpaper-frontend/pages/classlist/classlist.vue'\nwx.createPage(MiniProgramPage)"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;IAuBA,IAAMA,WAAA,GAAc;MAACC,WAAA,EAAa;MAASC,cAAA,EAAgB;MAAUC,aAAA,EAAe;IAAS;IAC7F,IAAMC,WAAA,GAAcC,aAAA,CAAGC,GAAA,CAAC,EAAE;IAC1B,IAAIC,UAAA,GAAa;IACjB,IAAIC,OAAA,GAAUH,aAAA,CAAGC,GAAA,CAAC,EAAE;IACpB,IAAIG,MAAA,GAAS;IACb,IAAIC,MAAA,GAASL,aAAA,CAAGC,GAAA,CAAC,SAAS;IAE1BD,aAAA,CAAMM,MAAA,CAAC,UAAAC,CAAA,EAAG;MAET,IAAKC,EAAA,GAAMD,CAAA,CAANC,EAAA;MACLN,UAAA,GAAaM,EAAA;MAEbL,OAAA,CAAQM,KAAA,CAAMC,OAAA,GAAUF,EAAA;MACxBL,OAAA,CAAQM,KAAA,CAAME,QAAA,GAAW;MACzBR,OAAA,CAAQM,KAAA,CAAMG,OAAA,GAAU;MACxBC,cAAA,EAAgB;IACjB,CAAC;IAEDC,QAAA,CAAS,YAAI;MACZ,IAAI;QACHd,aAAA,CAAAe,KAAA,CAAIC,iBAAA,CAAkBd,UAAU;MAChC,SAAQK,CAAA,EAAG;QACXP,aAAA,CAAAe,KAAA,CAAAE,KAAA,+CAAYV,CAAC;MACb;IACF,CAAC;IAED,IAAMW,MAAA,GAAS,SAATA,OAAA,EAAe;MACpBlB,aAAA,CAAAe,KAAA,CAAII,YAAA,EAAc;IACnB;IAEAnB,aAAA,CAAAoB,aAAA,eAAAC,kBAAA,eAAAC,oBAAA,GAAAC,IAAA,CAAe,SAAAC,QAAA;MAAA,OAAAF,oBAAA,GAAAG,IAAA,UAAAC,SAAAC,QAAA;QAAA,kBAAAA,QAAA,CAAAC,IAAA,GAAAD,QAAA,CAAAE,IAAA;UAAA;YAAA,KAEXzB,MAAA;cAAAuB,QAAA,CAAAE,IAAA;cAAA;YAAA;YAAA,OAAAF,QAAA,CAAAG,MAAA;UAAA;YACH3B,OAAA,CAAQM,KAAA,CAAMG,OAAA;YACdC,cAAA,EAAgB;UAAA;UAAA;YAAA,OAAAc,QAAA,CAAAI,IAAA;QAAA;MAAA,GAAAP,OAAA;IAAA,CAChB;IAED,IAAMX,cAAA;MAAA,IAAAmB,KAAA,GAAAX,kBAAA,eAAAC,oBAAA,GAAAC,IAAA,CAAiB,SAAAU,SAAA;QAAA,IAAAC,GAAA;QAAA,OAAAZ,oBAAA,GAAAG,IAAA,UAAAU,UAAAC,SAAA;UAAA,kBAAAA,SAAA,CAAAR,IAAA,GAAAQ,SAAA,CAAAP,IAAA;YAAA;cAAAO,SAAA,CAAAP,IAAA;cAAA,OAEJQ,QAAA,CAAAC,iBAAA,CAAkBnC,OAAA,CAAQM,KAAK;YAAA;cAA3CyB,GAAA,GAAAE,SAAA,CAAAG,IAAA;cACNxC,WAAA,CAAYU,KAAA,MAAA+B,MAAA,CAAAC,mBAAA,CAAY1C,WAAA,CAAYU,KAAA,GAAAgC,mBAAA,CAASP,GAAA,CAAIQ,IAAI;cAErD,IAAGR,GAAA,CAAIQ,IAAA,CAAKC,MAAA,GAAO,IAAG;gBACrBvC,MAAA,GAAS;gBACTC,MAAA,CAAOI,KAAA,GAAQ;cACf;cAED,IAAI;gBACFT,aAAA,CAAAe,KAAA,CAAI6B,cAAA,CAAe1C,UAAA,EAAYH,WAAA,CAAYU,KAAK;cACjD,SAAQoC,GAAA,EAAK;gBACZ7C,aAAA,CAAAe,KAAA,CAAAE,KAAA,iDAAc,QAAQ4B,GAAG;cAC1B;YAAA;YAAA;cAAA,OAAAT,SAAA,CAAAL,IAAA;UAAA;QAAA,GAAAE,QAAA;MAAA,CACF;MAAA,gBAfMpB,eAAA;QAAA,OAAAmB,KAAA,CAAAc,KAAA,OAAAC,SAAA;MAAA;IAAA,GAeN;;;;;;;;;;;;;;;;;;;;;;;;;;;AC1EAC,EAAA,CAAGC,UAAA,CAAWC,eAAe","ignoreList":[]}