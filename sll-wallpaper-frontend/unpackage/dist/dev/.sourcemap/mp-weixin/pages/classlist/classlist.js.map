{"version":3,"file":"classlist.js","sources":["pages/classlist/classlist.vue","../../../../../../HBuilderX.4.45.2025010502/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvY2xhc3NsaXN0L2NsYXNzbGlzdC52dWU"],"sourcesContent":["<template>\n\t<view class=\"classlist\">\r\n\t\t<view class=\"mask\">\r\n\t\t\t<view class=\"goBack\" @click=\"goBack\" :style=\"{top:getStatusBarHeight()+'px'}\">\r\n\t\t\t\t<uni-icons type=\"back\" color=\"#fff\" size=\"20\"></uni-icons>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\t\t<view class=\"boxs\">\r\n\t\t\t<navigator :url=\"'/pages/preview/preview?id='+item._id+'&key='+storageKey\" class=\"box\" v-for=\"item in wallListPic\" :key=\"item._id\">\r\n\t\t\t\t\t<image :src=\"item.smallPicurl\" mode=\"aspectFill\" :ket=\"item._id\"></image>\r\n\t\t\t</navigator>\r\n\t\t</view>\r\n\t\t<view class=\"load\">\r\n\t\t\t<uni-load-more :status=\"status\" :contentText=\"contentText\"/>\r\n\t\t</view>\n\t</view>\n</template>\n\n<script setup>\r\nimport { ref } from 'vue';\r\nimport {onLoad,onReachBottom,onUnload} from \"@dcloudio/uni-app\"\nimport { apiGetWallListPic } from '../../api/apis';\r\nimport {getStatusBarHeight} from \"@/utils/system.js\"\r\nconst contentText = {contentdown: \"上拉显示更多\",contentrefresh: \"正在加载...\",contentnomore: \"没有更多图片了\"}\r\nconst wallListPic = ref([])\r\nlet storageKey = null\r\nlet classId = ref({})\r\nlet noMore = false\r\nlet status = ref('loading')\r\n\r\nonLoad(e=>{\r\n\t//获取url参数id的值\r\n\tlet {id} = e\r\n\tstorageKey = id\r\n\t//给请求data参数赋值\r\n\tclassId.value.classid = id\r\n\tclassId.value.pageSize = 12\r\n\tclassId.value.pageNum = 1\r\n\tgetWallListPic()\r\n})\r\n\r\nonUnload(()=>{\r\n\ttry {\r\n\t\tuni.removeStorageSync(storageKey);\r\n\t} catch (e) {\r\n\t\tconsole.log(e)\r\n\t}\r\n})\r\n\r\nconst goBack = () => {\r\n\tuni.navigateBack()\r\n}\r\n\r\nonReachBottom( async ()=>{\r\n\t//触底有其他图片则进行网络请求，没有则不执行\r\n\tif(noMore)return\r\n\tclassId.value.pageNum++\r\n\tgetWallListPic()\r\n})\r\n\r\nconst getWallListPic = async ()=>{\r\n\t//获取响应数据\r\n\tconst res = await apiGetWallListPic(classId.value)\r\n\twallListPic.value = [...wallListPic.value,...res.data]\r\n\t//判断服务器是否还有更多图片\r\n\tif(res.data.length<12){\r\n\t\tnoMore = true\r\n\t\tstatus.value = 'noMore'\r\n\t}\r\n\t//将数据本地缓存\r\n\ttry {\r\n\t  uni.setStorageSync(storageKey, wallListPic.value);\r\n\t} catch (err) {\r\n\t  console.error('存储失败', err);\r\n\t}\r\n}\r\n\r\n\n</script>\n\n<style lang=\"scss\" scoped>\n.classlist{\r\n\tposition: relative;\r\n\twidth: 100vw;\r\n\theight: 100vh;\r\n\t.mask{\r\n\t\t.goBack {\r\n\t\t    width: 76rpx;\r\n\t\t    height: 76rpx;\r\n\t\t\tpadding: 20rpx;\r\n\t\t    background: rgba(0, 0, 0, 0.5);\r\n\t\t    left: 30rpx;\r\n\t\t    top: 30rpx; /* 增加顶部间距 */\r\n\t\t    margin-left: 0;\r\n\t\t    border-radius: 50%;\r\n\t\t    backdrop-filter: blur(10rpx);\r\n\t\t    border: 1rpx solid rgba(255, 255, 255, 0.3);\r\n\t\t    display: flex;\r\n\t\t    align-items: center;\r\n\t\t    justify-content: center;\r\n\t\t    position: fixed; /* 使用 fixed 定位确保相对于屏幕 */\r\n\t\t}\n\t}\r\n\t.boxs{\r\n\t\twidth: 100%;\r\n\t\tpadding: 5rpx;\r\n\t\tdisplay: grid;\r\n\t\tgrid-template-columns: repeat(3,1fr);\r\n\t\tgap: 5rpx;\r\n\t\t.box{\r\n\t\t\twidth: 100%;\r\n\t\t\theight: 545rpx;\r\n\t\t\timage{\r\n\t\t\t\twidth: 100%;\r\n\t\t\t\theight: 100%;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t.load{\r\n\t\tpadding: 30rpx 0;\r\n\t}\r\n}\n</style>\n","import MiniProgramPage from 'C:/Users/yuweikai/Documents/HBuilderProjects/sll-wallpaper/sll-wallpaper-frontend/pages/classlist/classlist.vue'\nwx.createPage(MiniProgramPage)"],"names":["ref","onLoad","onUnload","uni","onReachBottom","apiGetWallListPic"],"mappings":";;;;;;;;;;;;;;;;;AAuBA,UAAM,cAAc,EAAC,aAAa,UAAS,gBAAgB,WAAU,eAAe,UAAS;AAC7F,UAAM,cAAcA,cAAG,IAAC,EAAE;AAC1B,QAAI,aAAa;AACjB,QAAI,UAAUA,cAAG,IAAC,EAAE;AACpB,QAAI,SAAS;AACb,QAAI,SAASA,cAAG,IAAC,SAAS;AAE1BC,kBAAM,OAAC,OAAG;AAET,UAAI,EAAC,GAAE,IAAI;AACX,mBAAa;AAEb,cAAQ,MAAM,UAAU;AACxB,cAAQ,MAAM,WAAW;AACzB,cAAQ,MAAM,UAAU;AACxB,qBAAgB;AAAA,IACjB,CAAC;AAEDC,kBAAAA,SAAS,MAAI;AACZ,UAAI;AACHC,4BAAI,kBAAkB,UAAU;AAAA,MAChC,SAAQ,GAAG;AACXA,sBAAAA,MAAA,MAAA,OAAA,uCAAY,CAAC;AAAA,MACb;AAAA,IACF,CAAC;AAED,UAAM,SAAS,MAAM;AACpBA,oBAAAA,MAAI,aAAc;AAAA,IACnB;AAEAC,kBAAAA,cAAe,YAAU;AAExB,UAAG;AAAO;AACV,cAAQ,MAAM;AACd,qBAAgB;AAAA,IACjB,CAAC;AAED,UAAM,iBAAiB,YAAU;AAEhC,YAAM,MAAM,MAAMC,2BAAkB,QAAQ,KAAK;AACjD,kBAAY,QAAQ,CAAC,GAAG,YAAY,OAAM,GAAG,IAAI,IAAI;AAErD,UAAG,IAAI,KAAK,SAAO,IAAG;AACrB,iBAAS;AACT,eAAO,QAAQ;AAAA,MACf;AAED,UAAI;AACFF,sBAAAA,MAAI,eAAe,YAAY,YAAY,KAAK;AAAA,MACjD,SAAQ,KAAK;AACZA,sBAAA,MAAA,MAAA,SAAA,uCAAc,QAAQ,GAAG;AAAA,MAC1B;AAAA,IACF;;;;;;;;;;;;;;;;;;;;;;;;;;;AC1EA,GAAG,WAAW,eAAe;"}